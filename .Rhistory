mydata = read.csv("weight.ods")
View(mydata)
mydata = read.csv("weight.csv")
hist(mydata$Morning)
plot(mydata$Date, mydata$Morning)
str(mydata)
mydata$Date <- as.Date(mydata$Date)
plot(mydata$Date, mydata$Morning)
library(tidyr)
datalong <- gather(mydata, time, weight, Morning, Afternoon)
datalong
View(datalong)
plot(datalong$Date, datalong$weight, col=datalong$time)
str(datalong)
datalong$time <- as.factor(datalong$time)
plot(datalong$Date, datalong$weight, col=datalong$time)
legend("topright",legend = unique(datalong$time, fill=unique(datalong$time)))
plot(datalong$Date, datalong$weight, col=datalong$time)
palette(rainbow(2))
plot(datalong$Date, datalong$weight, col=datalong$time)
library(ggplot2)
p <- ggplot(data = datalong, aes(x = Date, y = weight))
p
p + geom_point()
p <- ggplot(data = datalong, aes(x = Date, y = weight, color=time))
p + geom_point()
p + geom_point() + geom_smooth(method = "lm")
p <- ggplot(data = datalong, aes(x = Date, y = weight))
p + geom_point(aes(color = time) + geom_smooth(method = "lm")
p <- ggplot(data = datalong, aes(x = Date, y = weight))
p + geom_point(aes(color = time)) + geom_smooth(method = "lm")
lm1 <- lm(weight ~ Date, data=datalong)
summary(lm1)
datalong
datalong$ID seq.int(nrow(datalong))
datalong$ID <- seq.int(nrow(datalong))
lm1 <- lm(weight ~ ID, data=datalong)
datalong$ID <- seq.int(nrow(datalong))
summary(lm1)
predict(lm1, newdata = new.weight)
new.weight <- data.frame(
speed = c(-7, 7, 14, 21, 28)
)
mydata$ID <- seq.int(nrow(mydata))
datalong <- gather(mydata, time, weight, Morning, Afternoon)
lm1 <- lm(weight ~ ID, data=datalong)
summary(lm1)
predict(lm1, newdata = new.weight)
new.weight <- data.frame(
ID = c(-7, 7, 14, 21, 28)
)
predict(lm1, newdata = new.weight)
new.weight <- data.frame(
ID = c(-7, 21, 28, 35, 42)
)
predict(lm1, newdata = new.weight)
p + geom_point(aes(color = time)) + geom_smooth(method = "lm")
p1 <- p + geom_point(aes(color = time)) + geom_smooth(method = "lm")
p1 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
scale_x_continuous("Date", labels = as.character(Date), breaks = (Date))
p1 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
xlab("Date")
p1 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
scale_x_continuous("Date")
p1 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
scale_x_date(date_breaks = "1 day")
p1 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
scale_x_date(date_breaks = "1 day", data_labels = "%D")
p1 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
scale_x_date(date_breaks = "1 day", data_labels = "%W")
p1 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
scale_x_date(date_breaks = "1 day", date_labels = "%D")
p1 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
scale_x_date(date_breaks = "1 day", date_labels = "%b %e")
p2 <- p1 + theme(axis.text.x = element_text(angle = 90, vjust = 0.5)) +
scale_x_date(date_breaks = "1 day", date_labels = "%b %e")
View(p)
ggplot(datalong,aes(x=Date,y=weight)) + geom_point(aes(color = time)) + xlim(0,700) + stat_smooth(method="lm",fullrange=TRUE)
ggplot(datalong,aes(x=Date,y=weight)) + geom_point(aes(color = time)) + xlim(2020-11-01, 2020-12-31) + stat_smooth(method="lm",fullrange=TRUE)
ggplot(datalong,aes(x=Date,y=weight)) + geom_point(aes(color = time)) + xlim(as.Date(c('2020-11-01','2020-12-31'))) + stat_smooth(method="lm",fullrange=TRUE)
ep1 <- ggplot(datalong,aes(x=Date,y=weight)) + geom_point(aes(color = time)) + xlim(as.Date(c('2020-11-01','2020-12-31'))) + stat_smooth(method="lm",fullrange=TRUE)
ggsave("weightprediction.png", width = 8, height = 3, units = "in", res=300)
ggsave("weightprediction.png", width = 8, height = 3, units = "in", dpi=300)
